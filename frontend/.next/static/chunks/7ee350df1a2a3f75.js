(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70065,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(47163);let a=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("rounded-xl border border-gray-200 bg-white text-gray-950 shadow",e),...s}));a.displayName="Card";let i=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",e),...s}));i.displayName="CardHeader";let n=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("h3",{ref:a,className:(0,r.cn)("font-semibold leading-none tracking-tight",e),...s}));n.displayName="CardTitle",s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("p",{ref:a,className:(0,r.cn)("text-sm text-gray-500",e),...s})).displayName="CardDescription";let l=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("p-6 pt-0",e),...s}));l.displayName="CardContent",s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter",e.s(["Card",()=>a,"CardContent",()=>l,"CardHeader",()=>i,"CardTitle",()=>n])},67881,25913,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(7670);let a=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,i=r.clsx,n=(e,t)=>s=>{var r;if((null==t?void 0:t.variants)==null)return i(e,null==s?void 0:s.class,null==s?void 0:s.className);let{variants:n,defaultVariants:l}=t,c=Object.keys(n).map(e=>{let t=null==s?void 0:s[e],r=null==l?void 0:l[e];if(null===t)return null;let i=a(t)||a(r);return n[e][i]}),o=s&&Object.entries(s).reduce((e,t)=>{let[s,r]=t;return void 0===r||(e[s]=r),e},{});return i(e,c,null==t||null==(r=t.compoundVariants)?void 0:r.reduce((e,t)=>{let{class:s,className:r,...a}=t;return Object.entries(a).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...l,...o}[t]):({...l,...o})[t]===s})?[...e,s,r]:e},[]),null==s?void 0:s.class,null==s?void 0:s.className)};e.s(["cva",0,n],25913);var l=e.i(47163);let c=n("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-gray-950 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-gray-900 text-gray-50 shadow hover:bg-gray-900/90",destructive:"bg-red-500 text-gray-50 shadow-sm hover:bg-red-500/90",outline:"border border-gray-200 bg-white shadow-sm hover:bg-gray-100 hover:text-gray-900",secondary:"bg-gray-100 text-gray-900 shadow-sm hover:bg-gray-100/80",ghost:"hover:bg-gray-100 hover:text-gray-900",link:"text-gray-900 underline-offset-4 hover:underline",success:"bg-green-500 text-white shadow-sm hover:bg-green-500/90"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),o=s.forwardRef(({className:e,variant:s,size:r,...a},i)=>(0,t.jsx)("button",{className:(0,l.cn)(c({variant:s,size:r,className:e})),ref:i,...a}));o.displayName="Button",e.s(["Button",()=>o],67881)},54616,94179,e=>{"use strict";var t=e.i(71645),s=e.i(14272),r=e.i(40143),a=e.i(15823),i=e.i(19273),n=class extends a.Subscribable{#e;#t=void 0;#s;#r;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#a()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,i.shallowEqualObjects)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,i.hashKey)(t.mutationKey)!==(0,i.hashKey)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(e){this.#a(),this.#i(e)}getCurrentResult(){return this.#t}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#a(),this.#i()}mutate(e,t){return this.#r=t,this.#s?.removeObserver(this),this.#s=this.#e.getMutationCache().build(this.#e,this.options),this.#s.addObserver(this),this.#s.execute(e)}#a(){let e=this.#s?.state??(0,s.getDefaultState)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#i(e){r.notifyManager.batch(()=>{if(this.#r&&this.hasListeners()){let t=this.#t.variables,s=this.#t.context,r={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#r.onSuccess?.(e.data,t,s,r)}catch(e){Promise.reject(e)}try{this.#r.onSettled?.(e.data,null,t,s,r)}catch(e){Promise.reject(e)}}else if(e?.type==="error"){try{this.#r.onError?.(e.error,t,s,r)}catch(e){Promise.reject(e)}try{this.#r.onSettled?.(void 0,e.error,t,s,r)}catch(e){Promise.reject(e)}}}this.listeners.forEach(e=>{e(this.#t)})})}},l=e.i(12598);function c(e,s){let a=(0,l.useQueryClient)(s),[c]=t.useState(()=>new n(a,e));t.useEffect(()=>{c.setOptions(e)},[c,e]);let o=t.useSyncExternalStore(t.useCallback(e=>c.subscribe(r.notifyManager.batchCalls(e)),[c]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),d=t.useCallback((e,t)=>{c.mutate(e,t).catch(i.noop)},[c]);if(o.error&&(0,i.shouldThrowError)(c.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:d,mutateAsync:o.mutate}}e.s(["useMutation",()=>c],54616);var o=e.i(43476),d=e.i(25913),u=e.i(47163);let h=(0,d.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-gray-950 focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-gray-900 text-gray-50",secondary:"border-transparent bg-gray-100 text-gray-900",destructive:"border-transparent bg-red-500 text-gray-50",outline:"text-gray-950",success:"border-transparent bg-green-100 text-green-800",warning:"border-transparent bg-yellow-100 text-yellow-800",danger:"border-transparent bg-red-100 text-red-800",info:"border-transparent bg-blue-100 text-blue-800"}},defaultVariants:{variant:"default"}});function m({className:e,variant:t,...s}){return(0,o.jsx)("div",{className:(0,u.cn)(h({variant:t}),e),...s})}e.s(["Badge",()=>m],94179)},3116,e=>{"use strict";let t=(0,e.i(75254).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>t],3116)},78894,e=>{"use strict";let t=(0,e.i(75254).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>t],78894)},14764,e=>{"use strict";let t=(0,e.i(75254).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],14764)},69638,e=>{"use strict";let t=(0,e.i(75254).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],69638)},16715,e=>{"use strict";let t=(0,e.i(75254).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},11797,e=>{"use strict";var t=e.i(43476),s=e.i(66027),r=e.i(54616),a=e.i(54858),i=e.i(67881),n=e.i(70065),l=e.i(94179),c=e.i(47163),o=e.i(45423),d=e.i(14764),u=e.i(69638);let h=(0,e.i(75254).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var m=e.i(3116),x=e.i(78894),p=e.i(16715);function y(){let{data:e,isLoading:y,refetch:g}=(0,s.useQuery)({queryKey:["notifications"],queryFn:async()=>(await a.lineApi.getNotifications({limit:100})).data.data}),f=(0,r.useMutation)({mutationFn:()=>a.lineApi.triggerNotifications(),onSuccess:()=>{g()}});return(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"การแจ้งเตือน"}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:"ประวัติการส่งแจ้งเตือน LINE และสถานะ"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(i.Button,{variant:"outline",onClick:()=>g(),children:[(0,t.jsx)(p.RefreshCw,{className:"h-4 w-4 mr-2"}),"รีเฟรช"]}),(0,t.jsxs)(i.Button,{onClick:()=>f.mutate(),disabled:f.isPending,children:[(0,t.jsx)(d.Send,{className:"h-4 w-4 mr-2"}),f.isPending?"กำลังส่ง...":"ส่งแจ้งเตือนตอนนี้"]})]})]}),(0,t.jsx)(n.Card,{className:"bg-blue-50 border-blue-200",children:(0,t.jsx)(n.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(o.Bell,{className:"h-5 w-5 text-blue-600 mt-0.5"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium text-blue-900",children:"ระบบแจ้งเตือนอัตโนมัติ"}),(0,t.jsxs)("p",{className:"text-sm text-blue-700 mt-1",children:["ระบบจะส่งแจ้งเตือนอัตโนมัติทุกวันเวลา 09:00 น. ตามเวลาประเทศไทย",(0,t.jsx)("br",{}),"• แจ้งล่วงหน้า 1 วัน ก่อนครบกำหนด",(0,t.jsx)("br",{}),"• แจ้งในวันครบกำหนด",(0,t.jsx)("br",{}),"• แจ้งหากมีรายการค้างชำระ"]})]})]})})}),f.isSuccess&&(0,t.jsx)(n.Card,{className:"bg-green-50 border-green-200",children:(0,t.jsx)(n.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(u.CheckCircle,{className:"h-5 w-5 text-green-600"}),(0,t.jsx)("p",{className:"text-green-800",children:"ส่งแจ้งเตือนเรียบร้อยแล้ว! กรุณารีเฟรชเพื่อดูผลลัพธ์"})]})})}),(0,t.jsxs)(n.Card,{children:[(0,t.jsx)(n.CardHeader,{children:(0,t.jsx)(n.CardTitle,{children:"ประวัติการแจ้งเตือน"})}),(0,t.jsx)(n.CardContent,{children:y?(0,t.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsx)("div",{className:"animate-pulse h-16 bg-gray-100 rounded-lg"},s))}):e?.length===0?(0,t.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,t.jsx)(o.Bell,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,t.jsx)("p",{children:"ยังไม่มีประวัติการแจ้งเตือน"})]}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b text-left",children:[(0,t.jsx)("th",{className:"pb-3 font-medium text-gray-600",children:"เวลา"}),(0,t.jsx)("th",{className:"pb-3 font-medium text-gray-600",children:"ลูกค้า"}),(0,t.jsx)("th",{className:"pb-3 font-medium text-gray-600",children:"รายการ"}),(0,t.jsx)("th",{className:"pb-3 font-medium text-gray-600",children:"ประเภท"}),(0,t.jsx)("th",{className:"pb-3 font-medium text-gray-600",children:"สถานะ"})]})}),(0,t.jsx)("tbody",{className:"divide-y",children:e?.map(e=>{var s;let r=(s=e.notification_type,({before_due:{label:"แจ้งล่วงหน้า 1 วัน",color:"bg-blue-100 text-blue-800",icon:(0,t.jsx)(m.Clock,{className:"h-4 w-4"})},on_due:{label:"แจ้งวันครบกำหนด",color:"bg-yellow-100 text-yellow-800",icon:(0,t.jsx)(x.AlertTriangle,{className:"h-4 w-4"})},overdue:{label:"แจ้งค้างชำระ",color:"bg-red-100 text-red-800",icon:(0,t.jsx)(x.AlertTriangle,{className:"h-4 w-4"})}})[s]||{label:s,color:"bg-gray-100 text-gray-800",icon:null});return(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"py-3 text-sm text-gray-600",children:new Date(e.sent_at).toLocaleString("th-TH",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,t.jsx)("td",{className:"py-3 font-medium",children:e.customer_name}),(0,t.jsxs)("td",{className:"py-3",children:[(0,t.jsxs)("div",{className:"text-sm",children:[e.product_name&&(0,t.jsx)("span",{children:e.product_name}),e.amount&&(0,t.jsx)("span",{className:"text-gray-500 ml-2",children:(0,c.formatCurrency)(e.amount)})]}),e.due_date&&(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["ครบกำหนด: ",(0,c.formatShortDate)(e.due_date)]})]}),(0,t.jsx)("td",{className:"py-3",children:(0,t.jsxs)("div",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${r.color}`,children:[r.icon,r.label]})}),(0,t.jsx)("td",{className:"py-3",children:"success"===e.status?(0,t.jsxs)(l.Badge,{variant:"success",children:[(0,t.jsx)(u.CheckCircle,{className:"h-3 w-3 mr-1"}),"สำเร็จ"]}):(0,t.jsxs)("div",{children:[(0,t.jsxs)(l.Badge,{variant:"danger",children:[(0,t.jsx)(h,{className:"h-3 w-3 mr-1"}),"ล้มเหลว"]}),e.error_message&&(0,t.jsx)("p",{className:"text-xs text-red-600 mt-1",children:e.error_message})]})})]},e.id)})})]})})})]})]})}e.s(["default",()=>y],11797)}]);